ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scale::pretty_breaks(c(0.5, 1, 10, 100, 200, 400, 800, 900))) +
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks(c(0.5, 1, 10, 100, 200, 400, 800, 900))) +
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks()) +
coord_trans(y = "log10")
?scales::pretty_breaks
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) +
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 5)) +
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 8)) +
coord_trans(y = "log10")
?pretty
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks(c(0.5, 1, 10, 100, 200, 400, 800, 900)), labels = comma()) +
coord_trans(y = "log10")
library(scales)
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = scales::pretty_breaks(c(0.5, 1, 10, 100, 200, 400, 800, 900)), labels = comma) +
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 900), labels = comma) +
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 1000), labels = comma) +
coord_trans(y = "log10")
?scale_x_continuous
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 1000),
scales::number_format(accuracy = 0.5))+
coord_trans(y = "log10")
?number_format
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 1000),
scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 1000),
scales::label_comma(accuracy = 0.01))+
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 1000),
labels = scales::label_comma(accuracy = 0.01))+
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 800, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10")
?geom_boxplot
?labs
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = None)
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = NONE)
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "")
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
plot_5 <-function(){
df %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_5()
head(df)
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
intake_condition  <- rlang::enquo(intake_cond)
if (intake_cond %in% "All") {
df5 <- df
} else {
df5 <- df %>% filter(intake_condition %in% !!intake_cond)
}
intake_condition  <- rlang::enquo(intake_cond)
plot_5 <-function(intake_cond = "All"){
if (intake_cond %in% "All") {
df5 <- df
} else {
intake_condition  <- rlang::enquo(intake_cond)
df5 <- df %>% filter(intake_condition %in% !!intake_cond)
}
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_5
plot_5()
plot_5("Healthy")
plot_5("Normal")
df5 <- df %>% filter(intake_condition %in% !!intake_condition_quo)
plot_5 <-function(intake_cond = "All"){
if (intake_cond %in% "All") {
df5 <- df
} else {
intake_condition_quo  <- rlang::enquo(intake_cond)
df5 <- df %>% filter(intake_condition %in% !!intake_condition_quo)
}
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_5()
plot_5("Normal")
plot_5("Pregnant")
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 50, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
plot_5 <-function(intake_cond = "All"){
if (intake_cond %in% "All") {
df5 <- df
} else {
intake_condition_quo  <- rlang::enquo(intake_cond)
df5 <- df %>% filter(intake_condition %in% !!intake_condition_quo)
}
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 50, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = "Days spent in shelter",
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_5(Pregnant)
plot_5("Pregnant")
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 50, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = paste0("Days spent in shelter for ",intake_cond," animals"),
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
plot_5 <-function(intake_cond = "All"){
if (intake_cond %in% "All") {
df5 <- df
} else {
intake_condition_quo  <- rlang::enquo(intake_cond)
df5 <- df %>% filter(intake_condition %in% !!intake_condition_quo)
}
df5 %>%
ggplot(aes(x = factor(animal_type), y = total_time_in_shelter_days)) +
# geom_jitter( alpha = 0.1) +
geom_boxplot(outlier.alpha = 0.5, outlier.stroke = 0.1) +
scale_y_continuous(breaks = c(0.5, 1, 10, 50, 100, 200, 400, 600, 1000),
labels = scales::label_comma(accuracy = 0.1))+
coord_trans(y = "log10") +
labs(title = paste0("Days spent in shelter for ",intake_cond," animals"),
y = "Days",
x = "") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_5("Pregnant")
glimpse(df)
# Plotting
df4 %>%
ggplot(aes(x = `age_upon_outcome_(days)`))+
geom_histogram()
# Filtering condition
df4 <- df
# Plotting
df4 %>%
ggplot(aes(x = `age_upon_outcome_(days)`))+
geom_histogram()
# Plotting
df4 %>%
ggplot(aes(x = `age_upon_outcome_(days)`, y = stat(count)))+
geom_density()
# Plotting
df4 %>%
ggplot(aes(x = `age_upon_outcome_(days)`, y = stat(count)))+
geom_histogram()
# Plotting
df4 %>%
ggplot(aes(x = `age_upon_outcome_(days)`, y = stat(count)))+
geom_histogram(color = "blue")
# Plotting
df4 %>%
ggplot(aes(x = `age_upon_outcome_(days)`, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue")
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ",),
x = "Intake Age")
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ",),
x = "Intake Age (Year)",
y = "Count")
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ",),
x = "Intake Age (Year)",
y = "Count")
title_string = ifelse(animal_type_choice %in% "All", "all animals", animal_type_choice)
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "all animals", animal_type_choice)
# Filtering condition
if (animal_type %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count")
}
plot_4()
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "all animals", animal_type_choice)
# Filtering condition
if (animal_type_choice %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count")
}
plot_4()
# General wrangling
df <- df %>% mutate(age_years = `age_upon_intake_(days)`/365)
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "all animals", animal_type_choice)
# Filtering condition
if (animal_type_choice %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count")
}
plot_4()
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count") +
theme(plot.title = element_text(hjust = 0.5))
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "all animals", animal_type_choice)
# Filtering condition
if (animal_type_choice %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_4()
plot_4("Cat")
title_string = ifelse(animal_type_choice %in% "All", "all animals", paste0(animal_type_choice,"s"))
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "all animals", paste0(animal_type_choice,"s"))
# Filtering condition
if (animal_type_choice %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_4("Cat")
title_string = ifelse(animal_type_choice %in% "All", "All Animals", paste0(animal_type_choice,"s"))
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "All Animals", paste0(animal_type_choice,"s"))
# Filtering condition
if (animal_type_choice %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue") +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_4("Cat")
plot_4("Dog")
?geom_histogram
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue", binwidth = 0.5) +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count") +
theme(plot.title = element_text(hjust = 0.5))
# Plot 4
plot_4 <- function(animal_type_choice = "All"){
title_string = ifelse(animal_type_choice %in% "All", "All Animals", paste0(animal_type_choice,"s"))
# Filtering condition
if (animal_type_choice %in% "All") {
df4 <- df
} else {
animal_type_quo = enquo(animal_type_choice)
df4 <- df %>% filter(animal_type %in% !!animal_type_quo)
}
# Plotting
df4 %>%
ggplot(aes(x = age_years, y = stat(count)))+
geom_histogram(color = "blue", fill = "blue", binwidth = 0.5) +
labs(title = paste0("Age Distribution of ", title_string),
x = "Intake Age (Year)",
y = "Count") +
theme(plot.title = element_text(hjust = 0.5))
}
plot_4("Dog")
plot_4()
plot_5()
